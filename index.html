<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHF/JPY Signal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            font-size: 24px;
        }
        h2 {
            font-size: 30px;
            font-weight: bold;
            margin-top: 20px;
        }
        .buy {
            color: green;
        }
        .sell {
            color: red;
        }
        .strong-buy {
            color: darkgreen;
            font-size: 20px;
            font-weight: bold;
        }
        .strong-sell {
            color: darkred;
            font-size: 20px;
            font-weight: bold;
        }
        .no-entry {
            color: gray;
        }
    </style>
</head>
<body>
    <h1>CHF/JPY Signal</h1>
    <h2 id="signal" class="no-entry">Loading...</h2>
    <p id="strong-signal"></p> 
    <p id="price">CHF/JPY: --</p>
    <p id="two-min-entry">2 Min Entry: --</p>
    <p id="last-update">Last Update: --</p>
    <p id="live-time">Live Time: --</p>

    <script>
        let priceHistory = [];
        let strongSignalTimer = null;

        async function fetchLivePrice() {
            try {
                const response = await fetch("https://api.twelvedata.com/price?symbol=CHF/JPY&apikey=YOUR_API_KEY");
                const data = await response.json();
                let price = parseFloat(data.price).toFixed(3);

                let liveTime = new Date().toLocaleTimeString();
                document.getElementById('price').innerText = "CHF/JPY: " + price;
                document.getElementById('live-time').innerText = "Live Time: " + liveTime;

                updatePriceHistory(price);
            } catch (error) {
                console.error("Error fetching live price:", error);
            }
        }

        function updatePriceHistory(price) {
            priceHistory.push(price);
            if (priceHistory.length > 120) {
                priceHistory.shift(); // Keep last 2 minutes of price data
            }
        }

        function checkSignal() {
            if (priceHistory.length < 120) return;

            let currentPrice = priceHistory[priceHistory.length - 1];
            let twoMinAgoPrice = priceHistory[0];

            document.getElementById('two-min-entry').innerText = "2 Min Entry: " + twoMinAgoPrice;

            let signal = "No Entry";
            let strongSignal = "";

            if (currentPrice > twoMinAgoPrice) {
                signal = "BUY";
                if (strongSignalTimer === null) {
                    strongSignalTimer = setTimeout(() => {
                        strongSignal = "Strong Buy";
                        updateUI(signal, strongSignal);
                    }, 60000); // Wait 1 minute before confirming strong signal
                }
            } else if (currentPrice < twoMinAgoPrice) {
                signal = "SELL";
                if (strongSignalTimer === null) {
                    strongSignalTimer = setTimeout(() => {
                        strongSignal = "Strong Sell";
                        updateUI(signal, strongSignal);
                    }, 60000);
                }
            } else {
                clearTimeout(strongSignalTimer);
                strongSignalTimer = null;
            }

            updateUI(signal, strongSignal);
        }

        function updateUI(signal, strongSignal) {
            let signalElement = document.getElementById('signal');
            let strongSignalElement = document.getElementById('strong-signal');

            signalElement.innerText = signal;
            signalElement.className = signal.toLowerCase().replace(" ", "-");

            strongSignalElement.innerText = strongSignal || "";
            strongSignalElement.className = strongSignal.toLowerCase().replace(" ", "-");

            document.getElementById('last-update').innerText = "Last Update: " + new Date().toLocaleTimeString();

            if (signal === "BUY" || signal === "SELL") {
                alert(signal + " Signal Confirmed!");
            }
        }

        setInterval(fetchLivePrice, 1000); // Update price every second
        setInterval(checkSignal, 5000); // Update signal every 5 seconds
    </script>
</body>
</html>
