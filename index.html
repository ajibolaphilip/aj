<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHF/JPY Signal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            font-size: 24px;
        }
        h2 {
            font-size: 30px;
            font-weight: bold;
            margin-top: 20px;
        }
        .buy {
            color: green;
        }
        .sell {
            color: red;
        }
        .strong-buy {
            color: darkgreen;
            font-size: 20px;
            font-weight: bold;
        }
        .strong-sell {
            color: darkred;
            font-size: 20px;
            font-weight: bold;
        }
        .no-entry {
            color: gray;
        }
    </style>
</head>
<body>
    <h1>CHF/JPY Signal</h1>
    <h2 id="signal" class="no-entry">Loading...</h2>
    <p id="strong-signal"></p> <!-- Strong buy/sell message -->
    <p id="price">CHF/JPY: --</p>
    <p id="time">Last Update: --</p>

    <script>
        let priceHistory = []; // Store last 12 price updates (1 minute)
        const requiredUpdates = 12; // 12 updates = 1 minute (5s interval)

        function fetchLivePrice() {
            // Simulated live price (replace with actual API fetch)
            let price = (167.7 + Math.random() * 0.8).toFixed(3); // Random price for demo
            
            document.getElementById('price').innerText = "CHF/JPY: " + price;
            document.getElementById('time').innerText = "Last Update: " + new Date().toLocaleTimeString();
            
            let signalElement = document.getElementById('signal');
            let strongSignalElement = document.getElementById('strong-signal');

            // Add price to history and keep only the last 12 values
            priceHistory.push(parseFloat(price));
            if (priceHistory.length > requiredUpdates) {
                priceHistory.shift();
            }

            let { signal, strongSignal } = determineSignal(priceHistory);

            if (signal === "Buy") {
                signalElement.innerText = "BUY";
                signalElement.className = "buy";
            } else if (signal === "Sell") {
                signalElement.innerText = "SELL";
                signalElement.className = "sell";
            } else {
                signalElement.innerText = "No Entry";
                signalElement.className = "no-entry";
            }

            if (strongSignal === "Strong Buy") {
                strongSignalElement.innerText = "Strong Buy";
                strongSignalElement.className = "strong-buy";
            } else if (strongSignal === "Strong Sell") {
                strongSignalElement.innerText = "Strong Sell";
                strongSignalElement.className = "strong-sell";
            } else {
                strongSignalElement.innerText = ""; // Clear strong signal if not confirmed
            }
        }

        function determineSignal(priceHistory) {
            if (priceHistory.length < requiredUpdates) {
                return { signal: "No Entry", strongSignal: "" };
            }

            let latestPrice = priceHistory[priceHistory.length - 1];
            let oldestPrice = priceHistory[0];
            let trendDirection = latestPrice - oldestPrice; // Check if price is increasing or decreasing

            let signal = "No Entry";
            let strongSignal = "";

            if (latestPrice > 168.1) {
                signal = "Buy";
                if (trendDirection > 0.1) { // Check if trend is moving UP strongly
                    strongSignal = "Strong Buy";
                }
            } else if (latestPrice < 167.9) {
                signal = "Sell";
                if (trendDirection < -0.1) { // Check if trend is moving DOWN strongly
                    strongSignal = "Strong Sell";
                }
            }

            return { signal, strongSignal };
        }

        // Fetch data every 5 seconds
        fetchLivePrice();
        setInterval(fetchLivePrice, 5000);
    </script>
</body>
</html>
